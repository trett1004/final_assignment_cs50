From 8f92dded5f381398418e345c8c62a1b1580bd9ce Mon Sep 17 00:00:00 2001
From: Katerina Koukiou <kkoukiou@redhat.com>
Date: Thu, 22 Dec 2022 14:34:50 +0100
Subject: [PATCH] fixup! message

---
 app.py                                        |   4 +--
 .../2029240f6d1128be89ddc32729463129          | Bin 9 -> 9 bytes
 templates/search.html                         |  29 +++++++++---------
 3 files changed, 16 insertions(+), 17 deletions(-)

diff --git app.py app.py
index 7cf4032..2057f2e 100644
--- app.py
+++ app.py
@@ -118,8 +118,8 @@ def remove_items():
 @app.route("/search", methods=["GET"])
 def search_items():
 # Search the entries (items) that are stored for the group in the database
-    search = request.args.get("q")
-    #db.execute("select name from groceries WHERE group_id = ? AND name LIKE ?", (session["enter_group"], '%'+ search + '%'))
+    search = request.args.get("q", "")
+    db.execute("select name from groceries WHERE group_id = ? AND name LIKE ?", (session["enter_group"], '%'+ search + '%'))
     print("route search_items q:", search)
     print("route search_items session enter_group:", session["enter_group"])
     data = db.fetchall()
diff --git flask_session/2029240f6d1128be89ddc32729463129 flask_session/2029240f6d1128be89ddc32729463129
index 04de15d01fe35710f04efd9b02c28a05a830f333..8669b54e5479f0826dc85b2a1cadcb9fac37aed9 100644
GIT binary patch
literal 9
QcmZQzU|?uq^=8!r00XuG1ONa4

literal 9
QcmZQzU|?uq^=8on00XoE0{{R3

diff --git templates/search.html templates/search.html
index 535ecd4..159bd95 100644
--- templates/search.html
+++ templates/search.html
@@ -18,32 +18,31 @@
     <!-- V1 | input type="submit" value="search"-->
 
 
-    <ul></ul>
+    <ul id="my_list"></ul>
 
     <script>
         let input = document.querySelector('input');
-        input.addEventListener('input', async function() {
-            console.info("iran 1");
-            let response = await fetch ('/?q=' + input.value);
-            let data = await response.text();
-            document.querySelector('ul').innerHTML = data;
-            console.info("iran 2");
+        input.addEventListener('input', event => {
+            const current_search = event.target.value;
+            let ul = document.querySelector("#my_list");
+            ul.innerHTML = "";
+            var items=[];
+            const list_data = {{ data|tojson }};
+            const list_data_filtered = list_data.filter(item => item.toLowerCase().includes(current_search.toLowerCase()));
+            list_data_filtered.forEach(element => {
+                var li = document.createElement('li');
+                ul.appendChild(li);
+                li.innerHTML = element;
+            });
         })
     </script>
 
 
 <!-- V1 |
-<br>
-    <ul>
-        {% for item in range(data|count) %}
-            <li>{{ data[item]}}</li>
-        {% endfor %}
-    </ul>
-
 {% endblock %}
 -->
 <!--
 <form autocomplete="off"><input type="text" name="q" id="q" onKeyUp="showResults(this.value)" />
     <div id="result"></div>
 </form>
--->
\ No newline at end of file
+-->
-- 
2.38.1

